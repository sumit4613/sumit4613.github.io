<!DOCTYPE html>
<html lang="en">
  <head>
    

<title>Moving Django Projects to a new server | Sumit Singh</title>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="I keep migrating django projects from one provider to another. Everytime, I have to look up the same steps. So I decided
to write them down here.
It is a bit of &hellip;" />
<meta property="og:description" content="I keep migrating django projects from one provider to another. Everytime, I have to look up the same steps. So I decided
to write them down here.
It is a bit of &hellip;" />
<meta property="og:site_name" content="Sumit Singh"/>
<meta property="og:type" content="website"/>
<meta property="og:title" content="Moving Django Projects to a new server | Sumit Singh"/>
<meta property="og:url" content="https://sumit4613.github.io/posts/move-django-projects-to-new-server/"/>
<link rel="canonical" href="https://sumit4613.github.io/posts/move-django-projects-to-new-server/"/>
<link rel="me" href="https://fosstodon.org/@sumit4613"/>
<script src="https://beamanalytics.b-cdn.net/beam.min.js" data-token="0a3e961b-6860-4254-899b-ad117e2017dd"
        async></script>


<link rel='icon' type='image/png' href='https://sumit4613.github.io/images/avatar.3628534a52ffff44dc80bf8c695cf2d9cba2fc8e396883029bdcc92b8dbe55e4.jpg'/>

<link rel="stylesheet" href="https://sumit4613.github.io/styles/base.min.b9b3e96732221a33ac09124c89605668179e8b35a2baf1798eb6c6dbe79bbf5c.css"/>

<script async defer src="https://sumit4613.github.io/scripts/base.min.11325d67d40c08e72f86327ea42b68f0094bdc7c02f5c5d0285064a166a4e578.js"></script>


  </head>
  
  <body class="bg-neutral-000">
    <section class="max-w-6xl mx-auto p-4 relative min-h-screen">
      <div class="md:flex md:justify-center md:mt-48">
        <aside>
          
<nav class="flex justify-between w-full items-center md:block mb-12 md:mb-0" aria-label="navigation">
  <a class="flex justify-end md:w-full md:mb-12" href="/">
    
    <img class="rounded-full h-8 w-8 md:h-12 md:w-12" alt="A circular photo of Sumit; links to home." src="https://sumit4613.github.io/images/avatar.3628534a52ffff44dc80bf8c695cf2d9cba2fc8e396883029bdcc92b8dbe55e4.jpg" />
  </a>
  <div class="text-right md:-mt-1 md:opacity-50 transition-opacity hover:opacity-100 focus:opacity-100">
    <div class="md:text-right">
      <ul class="-ml-2 md:ml-0 flex md:block">
        
        <li>
          <div class="portal font-semibold ~critical  text-critical-500 ">
            <a href="/portfolio/">
              
              <span>Portfolio</span>
              
            </a>
          </div>
          <br>
        </li>
        
        <li>
          <div class="portal font-semibold ~warning  active ">
            <a href="/posts/">
              
              <span>Posts</span>
              
            </a>
          </div>
          <br>
        </li>
        
      </ul>
    </div>
  </div>
</nav>

        </aside>
        <div class="md:min-w-xl md:max-w-xl md:mx-16">
          
          
<section>
    <div>
        
            
            <h3 class="inline heading font-bold md:text-4xl">
                Moving Django Projects to a new server
                
            </h3>
            <h3 class="inline heading font-bold md:text-4xl opacity-50">
                
            </h3>
            
    </div>
    <div class="mt-4">
        
        <span class="chip ~neutral !low -ml-2 mb-2">
            Oct 2, 2022
        </span>
        
        
        
        <a class="chip ~neutral !normal bg-neutral-100 mb-2 mr-2" href="https://sumit4613.github.io/tags/django/" aria-label="tagged under Django">Django</a>
        
        
        
        <a class="chip ~neutral !normal bg-neutral-100 mb-2 mr-2" href="https://sumit4613.github.io/tags/ec2/" aria-label="tagged under Ec2">Ec2</a>
        
        
        
        <a class="chip ~neutral !normal bg-neutral-100 mb-2 mr-2" href="https://sumit4613.github.io/tags/nginx/" aria-label="tagged under Nginx">Nginx</a>
        
        
        
        <a class="chip ~neutral !normal bg-neutral-100 mb-2 mr-2" href="https://sumit4613.github.io/tags/postgres/" aria-label="tagged under Postgres">Postgres</a>
        
        
    </div>
</section>


          <hr class="sep h-8">
          
<main>
  <section class="content">
    <p>I keep migrating django projects from one provider to another. Everytime, I have to look up the same steps. So I decided
to write them down here.
It is a bit of a long post that contains various commands and sample config files, but I hope it will be useful to
someone.</p>
<p>I&rsquo;m assuming by now, you already created a new instance and is able to ssh into it.</p>
<h2 id="installupdate-server-dependencies">Install/Update Server Dependencies</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo apt-get update
</span></span><span class="line"><span class="cl">sudo apt-get -y upgrade
</span></span></code></pre></div><h3 id="postgresql">PostgreSQL</h3>
<p><em>Note: I install postgres inside the server, you can use RDS or some external service as well.</em></p>
<p><a href="https://sumit4613.github.io/posts/install-and-manage-postgres/">Install and Manage your own Postgres Server.</a></p>
<h3 id="nginx">NGINX</h3>
<p>Installing NGINX, which will be used to serve static assets (css, js, images) and also to run the Django application
behind a proxy server:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo apt-get -y install nginx
</span></span></code></pre></div><h3 id="supervisor">Supervisor</h3>
<p>I deploy different django projects (usually small scale, not much traffic) on the same server. To manage all of those I
use <code>Supervisor</code>. It&rsquo;s good for single
project as well. But if you want you can look for other ways to manage your project.</p>
<h4 id="install">Install</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo apt-get -y install supervisor
</span></span></code></pre></div><h4 id="enable-and-start-the-supervisor">Enable and start the Supervisor</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> supervisor
</span></span><span class="line"><span class="cl">sudo systemctl start supervisor
</span></span></code></pre></div><h3 id="install-virtual-environment">Install Virtual Environment</h3>
<p><em>I use simple requirements.txt file to install and manage the dependencies. You can use pipenv or poetry as well.</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo apt-get -y install python3-virtualenv
</span></span></code></pre></div><h3 id="install-python">Install Python</h3>
<p><em>Note: I&rsquo;ll be installing and using python3.8 due to some old dependencies.</em></p>
<p><a href="https://sumit4613.github.io/posts/install-python-in-ubuntu/">Install Python</a></p>
<h2 id="cloneset-up-the-project">Clone/Set up the project</h2>
<p><code>cd</code> into the directory where you want to clone the project and run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git clone https://github.com/101Loop/HisabKitab-BE.git  <span class="c1"># replace with your project url</span>
</span></span></code></pre></div><h3 id="createmanage-your-virtual-environment">Create/Manage your virtual environment</h3>
<p><code>cd</code> into the directory where you cloned the project and run:</p>
<h4 id="create-a-virtual-environment">Create a virtual environment</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> HisabKitab-BE/  <span class="c1"># replace with your project directory</span>
</span></span><span class="line"><span class="cl">virtualenv -p python3.8 .venv
</span></span></code></pre></div><ul>
<li><code>.venv</code> is the name of the virtual environment. You can use any name you want.</li>
<li><code>-p</code> is for python version.</li>
<li>I&rsquo;m using python3.8, you can use any version you want.</li>
<li>If you don&rsquo;t specify the python version, it will use the default python version.</li>
</ul>
<h4 id="activate-the-virtual-environment">Activate the virtual environment</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">source</span> .venv/bin/activate
</span></span></code></pre></div><h4 id="install-the-dependencies">Install the dependencies</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pip install -r requirements.txt
</span></span></code></pre></div><h4 id="update-settings-or-change-config-files-as-per-your-need">Update settings or change config files as per your need</h4>
<ul>
<li>I&rsquo;m using <code>django-environ</code> to manage the environment variables.</li>
<li>I&rsquo;ll just copy my <code>sample.env</code> file to <code>.env</code> and update the values.</li>
<li>You can use any other method to manage the environment variables.</li>
</ul>
<h3 id="check-if-everything-is-working-fine">Check if everything is working fine</h3>
<p>Migrate the database</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">python manage.py migrate  <span class="c1"># to run the migrations</span>
</span></span></code></pre></div><ul>
<li>Usually this is not required, since we&rsquo;re migrating the database from the old server.</li>
<li>Checkout how to <a href="https://sumit4613.github.io/posts/install-and-manage-postgres/">take dump and restore postgres db</a>.</li>
</ul>
<p>Collect Static Files</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">python manage.py collectstatic  <span class="c1"># to collect the static files</span>
</span></span></code></pre></div><p>Run the server</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">python manage.py runserver
</span></span></code></pre></div><ul>
<li>If this is working fine, you can stop the server by pressing <code>ctrl + c</code>.</li>
</ul>
<h2 id="configure-gunicorn">Configure Gunicorn</h2>
<p><strong>Note: Check this out for more details. <a href="https://docs.gunicorn.org/en/stable/deploy.html" target="_blank">
Deploying Gunicorn</a></strong></p>
<ul>
<li>First install <code>Gunicorn</code> if not already installed.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pip install gunicorn  <span class="c1"># make sure you&#39;re in the virtual environment</span>
</span></span></code></pre></div></li>
</ul>
<p><strong>Note: Go outside the project directory and run the following commands.</strong></p>
<ul>
<li>
<p>Create a directory for storing logs for debugging.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkdir logs
</span></span><span class="line"><span class="cl">mkdir logs/hisabkitab  <span class="c1"># to store logs for hisabkitab</span>
</span></span></code></pre></div></li>
<li>
<p>Create a directory for storing the socket files.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkdir sockets
</span></span></code></pre></div></li>
<li>
<p>I usually create a directory named <code>run_scripts</code> that contains all the gunicorn scripts to run the projects.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkdir run_scripts
</span></span></code></pre></div></li>
<li>
<p>Create a file named <code>&lt;product_name&gt;_gunicorn.sh</code> inside the <code>run_scripts</code> directory. (Not necessary to create inside
the <code>run_scripts</code> directory, you can create anywhere you want.)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">touch run_scripts/hisabkitab_gunicorn.sh  <span class="c1"># you can use any name</span>
</span></span></code></pre></div></li>
<li>
<p>Copy the content from
this <a href="https://gist.github.com/sumit4613/0b489a10d820211807224555e0f72f2b" target="_blank">Gunicorn Config</a>
and
paste
it in the file you just created. Make sure to update the values as per your need.</p>
</li>
<li>
<p>Make the file executable</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">chmod u+x run_scripts/hisabkitab_gunicorn.sh
</span></span></code></pre></div></li>
</ul>
<h2 id="configure-supervisor">Configure Supervisor</h2>
<ul>
<li>Create a new Supervisor configuration file.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo nano /etc/supervisor/conf.d/backend.conf
</span></span></code></pre></div></li>
<li>Copy the content from
this <a href="https://gist.github.com/sumit4613/91e5107102a86aa333ede5ee751a733f" target="_blank">Supervisor
Config</a> and
paste
it in the file you just created. Make sure to update the values as per your need.</li>
<li>Reread Supervisor configuration files and make the new program available.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo supervisorctl reread
</span></span><span class="line"><span class="cl">sudo supervisorctl update
</span></span></code></pre></div></li>
<li>Check status
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo supervisorctl status hisabkitab_supervisor  <span class="c1"># use your own program name</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">hisabkitab_supervisor            RUNNING   pid 9698, uptime 22:52:48
</span></span></span></code></pre></div><strong>Pro Tip: By running <code>sudo supervisorctl status</code> you can see the status of all your programs.</strong></li>
<li>To update the source code of the running application, pull the latest code using <code>git pull</code>, update requirements (if
required) and run the following command.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo supervisorctl restart hisabkitab_supervisor  <span class="c1"># use your own program name</span>
</span></span></code></pre></div></li>
</ul>
<h2 id="configure-nginx">Configure Nginx</h2>
<ul>
<li>Add a new configuration file named <code>hisabkitab.conf</code> inside /etc/nginx/sites-available/:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo nano /etc/nginx/sites-available/hisabkitab.conf
</span></span></code></pre></div></li>
<li>Copy the content from this <a href="https://gist.github.com/sumit4613/341ad0a0294039f62093a3d7b06c0c99" target="_blank">Nginx
Config</a> and
paste
it in the file you just created. Make sure to update the values as per your need.</li>
<li>Create a symbolic link to the sites-enabled directory to enable the site.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo ln -s /etc/nginx/sites-available/hisabkitab.conf /etc/nginx/sites-enabled
</span></span></code></pre></div></li>
<li>Test the configuration for syntax errors.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo nginx -t
</span></span></code></pre></div></li>
<li>Reload Nginx.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo service nginx restart
</span></span></code></pre></div></li>
</ul>
<h2 id="configure-certbot-lets-encrypt">Configure <a href="https://certbot.eff.org/">Certbot</a> (Let&rsquo;s Encrypt)</h2>
<ul>
<li>Install Certbot
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo apt install certbot python3-certbot-nginx
</span></span></code></pre></div></li>
<li>Run the following command to get the certificate.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo certbot --nginx
</span></span></code></pre></div></li>
<li>Follow the instructions on the screen to get the certificate for the required domain.</li>
<li>You can also use the following command to get the certificate.</li>
<li>This will automatically redirect all the traffic from <code>http</code> to <code>https</code>.
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo certbot --nginx -d &lt;domain_name&gt; -d www.&lt;domain_name&gt;
</span></span></code></pre></div></li>
</ul>
<p>Congratulations! You have successfully deployed 🚀 your Django application on the server. It should be running via https.</p>

  </section>
</main>


          <hr class="sep h-16">
          <footer>
            <footer class="family-secondary support content">
    
        <script src="https://giscus.app/client.js"
        data-repo="sumit4613/sumit4613.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxNzg0NTk0MDg="
        data-category="General"
        data-category-id="DIC_kwDOCqMTEM4CplMO"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
    
    <p class="pb-2">
        Hi! If you made it this far, maybe you want to stay in touch. You can follow me on <a
            href="https://twitter.com/sumitsingh4613">Twitter</a>, subscribe via <a href="/index.xml">Atom/RSS</a>.
    </p>
    <p class="pb-8">
        &copy; Sumit Singh 2025.
        Content is licensed <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>, a Free Culture
        License.
        The <a href="https://github.com/sumit4613/sumit4613.github.io">source code</a> is available under <a
            href="https://github.com/sumit4613/sumit4613.github.io/blob/master/LICENSE">GPLv3</a>.
        <i>If you see any issue or any typo please create an <a
                href="https://github.com/sumit4613/sumit4613.github.io/issues">issue here.</a></i>
        <br>
        <br>
    </p>
</footer>

          </footer>
        </div>
        <aside class="hidden pl-8 self-start sticky-top lg:block text-xs">
          
        </aside>
      </div>
    </section>
  </body>
  
</html>
