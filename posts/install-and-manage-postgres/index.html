<!DOCTYPE html>
<html lang="en">
  <head>
    

<title>Install and Manage your own PostgreSQL Server | Sumit Singh</title>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="Commands which I use to install and manage my own PostgreSQL server.
Install the dependencies to use Postgres with Python/Django
sudo apt-get -y install &hellip;" />
<meta property="og:description" content="Commands which I use to install and manage my own PostgreSQL server.
Install the dependencies to use Postgres with Python/Django
sudo apt-get -y install &hellip;" />
<meta property="og:site_name" content="Sumit Singh"/>
<meta property="og:type" content="website"/>
<meta property="og:title" content="Install and Manage your own PostgreSQL Server | Sumit Singh"/>
<meta property="og:url" content="https://sumit4613.github.io/posts/install-and-manage-postgres/"/>
<link rel="canonical" href="https://sumit4613.github.io/posts/install-and-manage-postgres/"/>
<link rel="me" href="https://fosstodon.org/@sumit4613"/>
<script src="https://beamanalytics.b-cdn.net/beam.min.js" data-token="0a3e961b-6860-4254-899b-ad117e2017dd"
        async></script>


<link rel='icon' type='image/png' href='https://sumit4613.github.io/images/avatar.3628534a52ffff44dc80bf8c695cf2d9cba2fc8e396883029bdcc92b8dbe55e4.jpg'/>

<link rel="stylesheet" href="https://sumit4613.github.io/styles/base.min.b9b3e96732221a33ac09124c89605668179e8b35a2baf1798eb6c6dbe79bbf5c.css"/>

<script async defer src="https://sumit4613.github.io/scripts/base.min.11325d67d40c08e72f86327ea42b68f0094bdc7c02f5c5d0285064a166a4e578.js"></script>


  </head>
  
  <body class="bg-neutral-000">
    <section class="max-w-6xl mx-auto p-4 relative min-h-screen">
      <div class="md:flex md:justify-center md:mt-48">
        <aside>
          
<nav class="flex justify-between w-full items-center md:block mb-12 md:mb-0" aria-label="navigation">
  <a class="flex justify-end md:w-full md:mb-12" href="/">
    
    <img class="rounded-full h-8 w-8 md:h-12 md:w-12" alt="A circular photo of Sumit; links to home." src="https://sumit4613.github.io/images/avatar.3628534a52ffff44dc80bf8c695cf2d9cba2fc8e396883029bdcc92b8dbe55e4.jpg" />
  </a>
  <div class="text-right md:-mt-1 md:opacity-50 transition-opacity hover:opacity-100 focus:opacity-100">
    <div class="md:text-right">
      <ul class="-ml-2 md:ml-0 flex md:block">
        
        <li>
          <div class="portal font-semibold ~critical  text-critical-500 ">
            <a href="/portfolio/">
              
              <span>Portfolio</span>
              
            </a>
          </div>
          <br>
        </li>
        
        <li>
          <div class="portal font-semibold ~warning  active ">
            <a href="/posts/">
              
              <span>Posts</span>
              
            </a>
          </div>
          <br>
        </li>
        
      </ul>
    </div>
  </div>
</nav>

        </aside>
        <div class="md:min-w-xl md:max-w-xl md:mx-16">
          
          
<section>
    <div>
        
            
            <h3 class="inline heading font-bold md:text-4xl">
                Install and Manage your own PostgreSQL Server
                
            </h3>
            <h3 class="inline heading font-bold md:text-4xl opacity-50">
                
            </h3>
            
    </div>
    <div class="mt-4">
        
        <span class="chip ~neutral !low -ml-2 mb-2">
            Sep 10, 2022
        </span>
        
        
        
        <a class="chip ~neutral !normal bg-neutral-100 mb-2 mr-2" href="https://sumit4613.github.io/tags/postgres/" aria-label="tagged under Postgres">Postgres</a>
        
        
        
        <a class="chip ~neutral !normal bg-neutral-100 mb-2 mr-2" href="https://sumit4613.github.io/tags/ubuntu/" aria-label="tagged under Ubuntu">Ubuntu</a>
        
        
        
        <a class="chip ~neutral !normal bg-neutral-100 mb-2 mr-2" href="https://sumit4613.github.io/tags/server/" aria-label="tagged under Server">Server</a>
        
        
        
        <a class="chip ~neutral !normal bg-neutral-100 mb-2 mr-2" href="https://sumit4613.github.io/tags/ec2/" aria-label="tagged under Ec2">Ec2</a>
        
        
        
        <a class="chip ~neutral !normal bg-neutral-100 mb-2 mr-2" href="https://sumit4613.github.io/tags/digitalocean/" aria-label="tagged under Digitalocean">Digitalocean</a>
        
        
        
        <a class="chip ~neutral !normal bg-neutral-100 mb-2 mr-2" href="https://sumit4613.github.io/tags/aws/" aria-label="tagged under Aws">Aws</a>
        
        
    </div>
</section>


          <hr class="sep h-8">
          
<main>
  <section class="content">
    <p><em>Commands which I use to install and manage my own PostgreSQL server.</em></p>
<p>Install the dependencies to use Postgres with Python/Django</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo apt-get -y install build-essential libpq-dev python3-dev
</span></span></code></pre></div><p>Install Postgres Server</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo apt-get -y install postgresql postgresql-contrib
</span></span></code></pre></div><h3 id="create-a-new-user">Create a new user</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo -u postgres createuser --interactive
</span></span></code></pre></div><p>After running the above command, you will be prompted something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Enter name of role to add: new-user
</span></span></span><span class="line"><span class="cl"><span class="go">Shall the new role be a superuser? (y/n) n
</span></span></span><span class="line"><span class="cl"><span class="go">Shall the new role be allowed to create databases? (y/n) y
</span></span></span><span class="line"><span class="cl"><span class="go">Shall the new role be allowed to create more new roles? (y/n) n
</span></span></span></code></pre></div><h3 id="create-database-and-grant-access-to-the-user">Create database and grant access to the user</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo -u postgres createdb hisabkitab --owner loop101
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo -u postgres psql -c <span class="s2">&#34;ALTER USER loop101 WITH PASSWORD &#39;my-strong-password&#39;;&#34;</span>
</span></span></code></pre></div><h3 id="backup-and-restore-in-sql-format">Backup and Restore in SQL format</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pg_dump -U db_user database_name &gt; path/to/backup.sql
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">psql -U db_user database_name &lt; path/to/backup.sql
</span></span></code></pre></div><h3 id="backing-up-a-specific-table">Backing up a specific table</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pg_dump -U db_user database_name -t table_name &gt; path/to/backup.sql
</span></span></code></pre></div><h3 id="restore-a-specific-table">Restore a specific table</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">psql -U db_user -d db_name &lt; path/to/backup.sql
</span></span></code></pre></div><h2 id="notes">Notes:</h2>
<ul>
<li>If you are using <code>psql</code> command, you might get an error like this:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">psql: error: connection to server on socket &#34;/var/run/postgresql/.s.PGSQL.5432&#34; failed: FATAL:
</span></span></span><span class="line"><span class="cl"><span class="go">Peer authentication failed for user &#34;new-user&#34;
</span></span></span></code></pre></div></li>
<li>To fix this, you can edit the <code>pg_hba.conf</code> file:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo nano /etc/postgresql/13/main/pg_hba.conf
</span></span></code></pre></div></li>
<li>Find <code># &quot;local&quot; is for Unix domain socket connections only</code> and add a new line below it:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">local</span>   all             new-user                              password
</span></span></code></pre></div></li>
<li>Restart the postgres service:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo systemctl restart postgresql
</span></span></code></pre></div></li>
<li>Now you can use <code>psql</code> command without any issues.</li>
</ul>

  </section>
</main>


          <hr class="sep h-16">
          <footer>
            <footer class="family-secondary support content">
    
        <script src="https://giscus.app/client.js"
        data-repo="sumit4613/sumit4613.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxNzg0NTk0MDg="
        data-category="General"
        data-category-id="DIC_kwDOCqMTEM4CplMO"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
    
    <p class="pb-2">
        Hi! If you made it this far, maybe you want to stay in touch. You can follow me on <a
            href="https://twitter.com/sumitsingh4613">Twitter</a>, subscribe via <a href="/index.xml">Atom/RSS</a>.
    </p>
    <p class="pb-8">
        &copy; Sumit Singh 2025.
        Content is licensed <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>, a Free Culture
        License.
        The <a href="https://github.com/sumit4613/sumit4613.github.io">source code</a> is available under <a
            href="https://github.com/sumit4613/sumit4613.github.io/blob/master/LICENSE">GPLv3</a>.
        <i>If you see any issue or any typo please create an <a
                href="https://github.com/sumit4613/sumit4613.github.io/issues">issue here.</a></i>
        <br>
        <br>
    </p>
</footer>

          </footer>
        </div>
        <aside class="hidden pl-8 self-start sticky-top lg:block text-xs">
          
        </aside>
      </div>
    </section>
  </body>
  
</html>
